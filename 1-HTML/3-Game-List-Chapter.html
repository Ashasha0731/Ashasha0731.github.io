<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Game-List-Chapter章節清單</title>
<link rel="icon" type="image/png" href="../0-IMAGE/0_Nav/logo-遊戲廳.png">    <!-- 網站圖標設定 -->
    <style>
    /* ==================== 全域樣式 ==================== */
        body, html {
            margin: 0; padding: 0;
            width: 100%; height: 100%;
            background: url('../0-IMAGE/1_Guide-page/星空背景.gif') center/cover no-repeat;
            font-family: "微軟正黑體", sans-serif;
            overflow: hidden;
        }

    /* ==================== 導覽列 ====================== */
        #header-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 60px;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            font-size: 20px;
            box-shadow: 0 3px 12px rgba(255, 255, 255, 0.4);
        }

    /* ==================== 星球輪撥 ====================== */   
        #planet-container {
            position: relative;
            width: 100%;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        .planet-track {
            display: flex;
            margin-left: 3800px;
            margin-bottom: 150px;
            transition: transform 0.5s ease;
        }

        /* 外層容器用於輪播平移 */
        .planet-wrapper {
            margin: 0 100px; /* 星球間距 */
            transition: all 0.5s ease;
        }

        .planet-inner {
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            animation: floatPlanet 3s ease-in-out infinite, rotatePlanet 10s linear infinite;
        }

        /* 星球基本樣式 */
        .planet {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            object-fit: contain;
            opacity: 0;
            filter: drop-shadow(0px 0px 10px #ffffffae);     /*增加符合PNG的陰影*/
            transform: scale(0.5);
            transition: all 0.5s ease;
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            0% {
                filter: drop-shadow(0 0 10px #ffffffae);
            }
            50% {
                filter: drop-shadow(0 0 25px #e2faffaa);
            }
            100% {
                filter: drop-shadow(0 0 10px #ffffffae);
            }
        }

        .planet.left, .planet.right {
            opacity: 0.2;
            transform: scale(0.8);
        }

        .planet.center {
            opacity: 1;
            transform: scale(2);
        }
        
        button {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0);
            border: none;
            color: #fff;
            font-size: 30px;
            cursor: pointer;
            z-index: 10;
        }

        /* 左右按鈕樣式 */
        button.prev-btn, button.next-btn {
            width: 65px;
            height: 65px;
            font-size: 25px;
            color: white;
            border: 2px solid white;
            background: rgba(0,0,0,0.6);
            cursor: pointer;
            border-radius: 50%;
            z-index: 20;
            transition: all 0.2s ease;
            animation: float 3s ease-in-out infinite alternate;
        }

        button.prev-btn { left: 200px; margin-top: -60px;}
        button.next-btn { right: 200px; margin-top: -60px;}

        button.prev-btn:hover,button.next-btn:hover {
            transform: translateY(-50%) scale(1.1);
        }


        /* 星球漂浮 + 旋轉動畫 */
        @keyframes floatPlanet {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        @keyframes rotatePlanet {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

/* =================== 章節標題 ===================== */
        .chapter-title {    /*章節*/
            font-size: 40px;
            position: fixed;
            top: 95px;
            left: 130px;
            z-index: 100;
            color: rgb(255, 255, 255);
            font-weight: bold;
            text-shadow: 
                0 0 5px #fff,
                0 0 10px rgb(88, 255, 255),
                0 0 20px #0ff,
                0 0 30px rgba(0, 255, 255, 0.45),
                0 0 40px rgba(0, 255, 255, 0.391);
            font-family: "微軟正黑體", sans-serif;
            display: block;          /* 確保可被置中 */
            width: 100%;             /* 可選，保證占滿橫向置中 */
            animation: float 3s ease-in-out infinite alternate;
        }

        .planet-wrapper .chapter-rate {   /*進度*/
            position: absolute;
            bottom: -100px;         
            width: 250px;
            margin-left: 200px;
            transform: translateX(-50%);
            text-align:left;      /* 文字內部置中 */
            font-size: 20px;
            color: rgb(255, 255, 255);
            text-shadow: 
                0 0 5px #fff,
                0 0 10px rgb(15, 6, 61),
                0 0 20px rgb(74, 82, 82),
                0 0 30px rgb(82, 91, 91),
                0 0 40px rgb(77, 90, 90);
            opacity: 0;
            transition: all 0.5s ease;
            animation: floatPlanet 3s ease-in-out infinite;
            pointer-events: none;
        }

        /* ✅ 左右側星球的進度 */
        .planet-wrapper .chapter-rate.left,
        .planet-wrapper .chapter-rate.right {
            transform: translate(-50%, 20px) scale(0.8);
            opacity: 0;               /* 預設隱藏 */
        }

        /* ✅ 中間星球 → 進度跟著放大+發光 */
        .planet-wrapper .chapter-rate.center {
            transform: translate(-50%, 20px) scale(1.3);
            opacity: 1;
            font-weight: bold;
        }

/* =================== 返回上一頁 ===================== */
        /* 左上角返回按鈕 */
        .back-btn {
            position: fixed;
            top: 95px;
            left: 20px;
            z-index: 2000;
            background: rgba(0,0,0,0.6);
            color: #fff;
            border: 2px solid white;
            padding: 12px 18px;
            font-size: 18px;
            font-weight: bold;
            border-radius: 12px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(250, 247, 247, 0.978);
            transition: all 0.2s ease;
            animation: float 3s ease-in-out infinite alternate;
        }

        .back-btn:hover {
            background: rgba(0,0,0,0.8);
            transform: scale(1.05);
        }

/* =================== 按鈕列-清單1 ===================== */
        .btn-list1 {
            position: fixed;
            bottom: 60px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1100;
        }

        /* 清單水平置中 */
        .big-buttons-centered {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            gap: 20px;
            padding: 0;
            margin: 0;
            list-style: none;
        }

        /* 每個按鈕固定高度 */
        .big-buttons-centered li a {
            width: 160px;
            min-height: 120px;
            display: flex;               /* 改成 flex 容器 */
            flex-direction: column;      /* 垂直排列 */
            justify-content: center;     /* 垂直置中 */
            align-items: center;         /* 水平置中 */
            border-radius: 24px;
            text-decoration: none;
            color: #fff;
            font-size: 1.1rem;
            font-weight: 700;
            background: linear-gradient(135deg, #222244, #4444cc);
            border: 2px solid rgba(255, 255, 255, 0.8);
            box-shadow: 0 8px 20px rgba(255, 255, 255, 0.5), 0 0 12px rgba(63,81,181,0.4) inset;
            animation: float 4s ease-in-out infinite alternate;
            transition: all .2s ease;
        }

        /* 中間按鈕放大 */
        .big-buttons-centered li:nth-child(2) a {
            min-height: 160px;
            width: 200px;
            font-size: 1.2rem;
            background: linear-gradient(145deg,#13d366,#2ca0ff53);
        }

        /* hover 效果 */
        .big-buttons-centered li a:hover {
            transform: translateY(-6px) scale(1.03);
            box-shadow: 0 18px 40px rgba(0,0,0,0.7), 0 0 20px rgba(255,255,255,0.2) inset;
        }

        /* 圖示區 */
        .btn-icon {
            width: 80px;
            height: 50px;
            display: grid;
            place-items: center;
            background: rgba(255,255,255,0.12);
            border-radius: 12px;
            flex-shrink: 0;
            transition: all .2s ease;
        }

        /* hover icon */
        .big-buttons-centered li a:hover .btn-icon {
            transform: translateY(-4px) scale(1.05);
            background: rgba(255,255,255,0.2);
        }

        /* 文字區 */
        .btn-label { display:block; text-align: center;  /* 文字水平置中 */}
        .btn-sub {
            display:block;
            font-size: .82rem;
            opacity: .85;
            font-weight: 500;
            color: #f0f0f0;
            text-align: center;  /* 文字水平置中 */
        }

        /* 漂浮動畫 */
        @keyframes float {
            0% { transform: translateY(0); }
            100% { transform: translateY(-8px); }
        }

/* ===================== 吉祥物 =================== */
/* ====== AI吉祥物- 彈出視窗 ====== */
        #Mrs_XL-1-container{
            position: fixed; /* 固定在螢幕頂端 */
            z-index: 50000;
            font-size: 20px;
            box-shadow: 0 3px 12px rgba(255, 255, 255, 0.4);/* 懸浮感陰影 */
        }
    /* ====== 彈出視窗內容 ====== */
        /* 視窗預設隱藏 */
        /* 彈窗淡入淡出 */
        .ai-popup-content {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 50%;
            height: 90%;
            background: rgba(0, 0, 0, 0.8);
            border-radius: 10px;
            z-index: 6000;
            box-shadow: 0 0 15px rgba(255,255,255,0.5);

            /* 動畫效果 */
            opacity: 0;
            transform: translate(-50%, -50%) scale(0.8);
            transition: opacity 0.4s ease, transform 0.4s ease;
        }

        .ai-popup-content.show {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
        }

        .ai-popup-content iframe {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 10px;
        }
        #close-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            background: #ff4d4d;
            border: none;
            color: white;
            font-size: 18px;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
        }

        /* 遮罩淡入淡出 */
        #ai-popup {
            position: fixed;
            top: 0; left: 0;
            width: 100vw; height: 100vh;
            background: rgba(0,0,0,0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 5000;

            /* 動畫效果 */
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.4s ease, visibility 0.4s ease;
        }

        #ai-popup.show {
            opacity: 1;
            visibility: visible;
        }

/* ===================== 底列 =================== */
        .footer {
            width: 100%;
            height: 50px; /* 高一點更舒適 */
            position: fixed;
            bottom: 0;
            left: 0;
            z-index: 1000;

            /* 漸層 + 半透明 + 毛玻璃 */
            background: linear-gradient(120deg, rgba(9,9,9,0.4), rgba(39,40,46,0.6), rgba(15,15,15,0.8));
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            border-top: 1px solid rgba(255,255,255,0.2); /* 頂部細邊框增加層次 */

            /* 文字樣式 */
            color: #ffffff;
            font-size: 14px;
            font-weight: 500;
            letter-spacing: 1px;
            text-shadow: 0 0 5px rgba(0,0,0,0.7);

            /* 置中 */
            display: flex;
            justify-content: center;
            align-items: center;

            /* 動態光暈（可選） */
            box-shadow: 0 0 15px rgba(255,255,255,0.2) inset;
        }

    </style>
</head>

<!--------------------------- html ----------------------------->
<body>
    <!-- 導覽列 -->
    <header>
        <div id="header-container"></div>
        <button  class="back-btn" onclick="enterBack()">返回</button>
    </header>

    <!-- 主頁區 -->
    <main>
        <!-- 章節文字 -->
        <span id="chapterTitleDisplay" class="chapter-title">第一章<span style="margin-left: -30px;">網頁安全探索</span></span>
        <!-- 星球輪播 -->
        <div id="planet-container">
            <button class="prev-btn">&#10094;</button>
            <button class="next-btn">&#10095;</button>
            <!-- 屬性 (data-attributes) -->
            <div class="planet-track" id="planet-track"> 
                <div class="planet-wrapper"><div class="planet-inner"><img class="planet" src="../0-IMAGE/Planet_ALL/星球1.png" data-title="第一章" data-subtitle="系統安全是什麼？"></div><span class="chapter-rate">"電腦就像你的房間：要有鎖（密碼）、要常打掃（更新）、不要讓陌生人亂開門（權限）。系統安全就是保護你的「數位房間」。"</span></div>
                <div class="planet-wrapper"><div class="planet-inner"><img class="planet" src="../0-IMAGE/Planet_ALL/星球2.png" data-title="第二章" data-subtitle="APT攻擊與網路攻擊鏈"></div><span class="chapter-rate">"進階持續性滲透（APT）就像電影裡的間諜：不是一次進來就走，而是悄悄待在裡面、慢慢取得信任與資料。"</span></div>
                <div class="planet-wrapper"><div class="planet-inner"><img class="planet" src="../0-IMAGE/Planet_ALL/星球3.png" data-title="第三章" data-subtitle="防火牆與封包檢查"></div><span class="chapter-rate">"防火牆像學校的門禁與值日生，決定誰可以進出；封包檢查則是檢查「信件」內容是否安全。"</span></div>
                <div class="planet-wrapper"><div class="planet-inner"><img class="planet" src="../0-IMAGE/Planet_ALL/星球4.png" data-title="第四章" data-subtitle="網站會被駭嗎？"></div><span class="chapter-rate">"簡單的密碼就像用透明膠帶當門鎖，容易被撬開；網站也會有被攻擊的風險，要學會找出弱點並加強門鎖。"</span></div>
                <div class="planet-wrapper"><div class="planet-inner"><img class="planet" src="../0-IMAGE/Planet_ALL/星球5.png" data-title="第五章" data-subtitle="檔案誰可以看？"></div><span class="chapter-rate">"存取權限就像寫日記給特定朋友看：寫上「只有媽媽能看」或「朋友可以留言」。權限要設定正確，才不會被不該看的人看到。"</span></div>
                <div class="planet-wrapper"><div class="planet-inner"><img class="planet" src="../0-IMAGE/Planet_ALL/星球6.png" data-title="第六章" data-subtitle="找出可疑的電腦行為"></div><span class="chapter-rate">"用 netstat 看電腦的「血管」，可以看到哪些連線在動；異常連線就像陌生人在你房間附近徘徊。"</span></div>
                <div class="planet-wrapper"><div class="planet-inner"><img class="planet" src="../0-IMAGE/Planet_ALL/星球7.png" data-title="第七章" data-subtitle="誰動了我的檔案？"></div><span class="chapter-rate">"稽核日誌像監視器錄影，可以回放誰進來過、做過什麼操作，幫助找出有問題的人或時間。"</span></div>
                <div class="planet-wrapper"><div class="planet-inner"><img class="planet" src="../0-IMAGE/Planet_ALL/星球8.png" data-title="第八章" data-subtitle="漏洞與密碼怎麼管？"></div><span class="chapter-rate">"漏洞就像沒關緊的窗戶或門縫，會被人鑽空子；密碼管理像是把鑰匙放在哪裡，放錯地方就容易丟失或被偷。"</span></div>
                <div class="planet-wrapper"><div class="planet-inner"><img class="planet" src="../0-IMAGE/Planet_ALL/星球9.png" data-title="第九章" data-subtitle="密碼怎麼傳？駭客怎麼偷"></div><span class="chapter-rate">"Hash 像門禁卡的序號：不會直接顯示原本密碼，但能用來比對是否正確；若傳輸不安全，駭客可能截取或冒用。"</span></div>
                <div class="planet-wrapper"><div class="planet-inner"><img class="planet" src="../0-IMAGE/Planet_ALL/星球10.png" data-title="第十章" data-subtitle="檔案怎麼保護？"></div><span class="chapter-rate">"chmod、ACL、雲端分享設定就像設定誰能看到你的相簿或誰能編輯文件：設定錯會讓不該看的人看到或改你的東西。"</span></div>
                <div class="planet-wrapper"><div class="planet-inner"><img class="planet" src="../0-IMAGE/Planet_ALL/星球11.png" data-title="第十一章" data-subtitle="機器學習入門"></div><span class="chapter-rate">"機器學習就像教一台機器分辨蘋果和香蕉：你給它很多範例，它會慢慢學會自己判類別，變成「數位小幫手」。"</span></div>
                <div class="planet-wrapper"><div class="planet-inner"><img class="planet" src="../0-IMAGE/Planet_ALL/星球12.png" data-title="第十二章" data-subtitle="AI 幫忙抓駭客"></div><span class="chapter-rate">"AI 可以幫資安人員像超級保全機器人一樣檢查大量資料、找出異常，但它也會有誤判，要人來監督。"</span></div>
                <div class="planet-wrapper"><div class="planet-inner"><img class="planet" src="../0-IMAGE/Planet_ALL/星球13.png" data-title="第十三章" data-subtitle="IDS & IPS 差在哪？"></div><span class="chapter-rate">"IDS 像監視器會「告訴你發生了什麼」，IPS 則像值勤警衛會「直接制止」不對的行為；兩者常配合使用。"</span></div>
            </div>
        </div>
    </main>

    <!-- 按鈕列-清單1 -->
    <div class="btn-list1">
        <ul class="big-buttons-centered" aria-label="主要功能選單">
            <li><a id="prev-chapter" href="#left">
                <span class="btn-icon" aria-hidden="true">
                    <!-- icon SVG -->
                     <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="bevel"><polygon points="11 19 2 12 11 5 11 19"></polygon><polygon points="22 19 13 12 22 5 22 19"></polygon></svg>
                </span>
                <span class="btn-label">上一章<span class="btn-sub">說明</span></span>
            </a></li>

            <li><a id="enterBtn">
                <button onclick="enterChapter()">
                    <span class="btn-icon" aria-hidden="true">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="bevel">
                            <circle cx="12" cy="12" r="10"/>
                            <path d="M16 12l-4-4-4 4M12 16V9"/>
                        </svg>
                    </span>
                    <span class="btn-label">進入<span class="btn-sub">前往該章節</span></span>
                </button></a></li>

            <li><a id="next-chapter" href="#right">
                <span class="btn-icon" aria-hidden="true">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="bevel"><polygon points="13 19 22 12 13 5 13 19"></polygon><polygon points="2 19 11 12 2 5 2 19"></polygon></svg>
                </span>
                <span class="btn-label">下一章<span class="btn-sub">說明</span></span>
            </a></li>
        </ul>
    </div>


    <!-- 固定元素-吉祥物 + AI對話框 -->
        <div id="Mrs_XL-1-container"></div>
        <!-- 嵌入colabAI -->
        <div id="ai-popup">
            <!-- ✅ 隱藏的彈出視窗(AI對話) -->
            <div class="ai-popup-content" id="aiPopup">
                <iframe src="0.11_colabAI.html" frameborder="0"></iframe>
                <button id="close-btn">✕</button>
            </div>
        </div>


    <!-- 頁尾 -->
    <footer class="footer">
        <!-- 可放文字或按鈕 -->
        <span >© 2025 中學生資訊安全網</span>
    </footer>




<!---------------------------- JS ------------------------------>
    <!-- 導覽列 -->
    <script>
        fetch('./0_Nav-2.html')
        .then(response => response.text())
        .then(data => { document.getElementById('header-container').innerHTML = data; })
        .catch(error => { console.error('載入 HTML 失敗:', error); });
    </script>

    <!-- 載入吉祥物 -->
    <script>
        fetch('./0.1_Mrs_XL-1.html')
            .then(res => res.text())
            .then(html => {
                const container = document.getElementById('Mrs_XL-1-container');
                container.innerHTML = html;

                // 執行吉祥物裡的 <script>
                const scripts = container.querySelectorAll('script');
                scripts.forEach(oldScript => {
                    const newScript = document.createElement('script');
                    if (oldScript.src) newScript.src = oldScript.src;
                    else newScript.textContent = oldScript.textContent;
                    document.body.appendChild(newScript);
                });

                // 綁定點擊吉祥物事件
                const mascot = document.getElementById("mascot");
                const aiPopupContainer = document.getElementById("ai-popup");
                const aiPopupContent = document.getElementById("aiPopup");
                const closeBtn = document.getElementById("close-btn");

                if (mascot && aiPopupContainer && aiPopupContent && closeBtn) {
                    mascot.addEventListener("click", () => {
                        aiPopupContainer.classList.add("show");
                        aiPopupContent.classList.add("show");
                    });

                    function closePopup() {
                        // 移除 show class 觸發淡出
                        aiPopupContent.classList.remove("show");
                        aiPopupContainer.classList.remove("show");
                    }

                    closeBtn.addEventListener("click", closePopup);

                    // 點遮罩也關閉
                    aiPopupContainer.addEventListener("click", e => {
                        if (e.target === e.currentTarget) {
                            closePopup();
                        }
                    });
                }
            });
    </script>

    <!-- 星球輪播 JS -->
    <script>
        const track = document.getElementById('planet-track');
        const wrappers = Array.from(track.children);
        let currentIndex = 0;

        // 定義每個章節的標題文字顏色
        const chapterColors = {
            "第一章": { color: "#FFF", shadow: "0 0 5px #fff,0 0 20px #6fabcb,0 0 30px #6fabcb" },
            "第二章": { color: "#FFF", shadow: "0 0 5px #fff,0 0 20px #f39a92,0 0 30px #f39a92" },
            "第三章": { color: "#FFF", shadow: "0 0 5px #fff,0 0 20px #c3b6b4,0 0 30px #c3b6b4" },
            "第四章": { color: "#FFF", shadow: "0 0 5px #fff,0 0 20px #d0bca5,0 0 30px #d0bca5" },
            "第五章": { color: "#FFF", shadow: "0 0 5px #fff,0 0 20px #db8a7d,0 0 30px #db8a7d" },
            "第六章": { color: "#FFF", shadow: "0 0 5px #fff,0 0 20px #67c76c,0 0 30px #67c76c" },
            "第七章": { color: "#FFF", shadow: "0 0 5px #fff,0 0 20px #a3bbde,0 0 30px #a3bbde" },
            "第八章": { color: "#FFF", shadow: "0 0 5px #fff,0 0 20px #a691df,0 0 30px #a691df" },
            "第九章": { color: "#FFF", shadow: "0 0 5px #fff,0 0 20px #00bb88,0 0 30px #00bb88" },
            "第十章": { color: "#FFF", shadow: "0 0 5px #fff,0 0 20px #f2a02e,0 0 30px #f2a02e" },
            "第十一章": { color: "#FFF", shadow: "0 0 5px #fff,0 0 20px #7f8e94,0 0 30px #7f8e94" },
            "第十二章": { color: "#FFF", shadow: "0 0 5px #fff,0 0 20px #f5e39c,0 0 30px #f5e39c" },
            "第十三章": { color: "#FFF", shadow: "0 0 50px #fff,0 0 20px #7464a7,0 0 30px #7464a7" }
        };

        function updatePlanets() {
            wrappers.forEach((w, i) => {
                const planet = w.querySelector('.planet');
                const rateText = w.querySelector('.chapter-rate');

                planet.className = 'planet';
                rateText.className = 'chapter-rate';
                
            });

            const total = wrappers.length;
            const leftIndex = (currentIndex - 1 + total) % total;
            const rightIndex = (currentIndex + 1) % total;

            wrappers[leftIndex].querySelector('.planet').classList.add('left');
            wrappers[currentIndex].querySelector('.planet').classList.add('center');
            wrappers[rightIndex].querySelector('.planet').classList.add('right');

            wrappers[leftIndex].querySelector('.chapter-rate').classList.add('left');
            wrappers[currentIndex].querySelector('.chapter-rate').classList.add('center');
            wrappers[rightIndex].querySelector('.chapter-rate').classList.add('right');

            // 更新中間星球的章節標題
            const currentPlanet = wrappers[currentIndex].querySelector('.planet');
            const title = currentPlanet.getAttribute("data-title");
            const subtitle = currentPlanet.getAttribute("data-subtitle");

            const chapterTitleDisplay = document.getElementById("chapterTitleDisplay");
            chapterTitleDisplay.innerHTML = `${title} &nbsp;&nbsp;&nbsp; <span>${subtitle}</span>`;

            // 計算輪播偏移量
            let offset = 0;
            for (let i = 0; i < currentIndex; i++) {
                const style = window.getComputedStyle(wrappers[i]);
                const w = wrappers[i].offsetWidth + parseInt(style.marginLeft) + parseInt(style.marginRight);
                offset += w;
            }
            const containerCenter = window.innerWidth / 2;
            const centerWidth = wrappers[currentIndex].offsetWidth;
            offset += centerWidth * 5 / 7;

            track.style.transform = `translateX(${containerCenter - offset - 138}px)`;

            // 取得章節標題元素
            const chapterTitle = document.querySelector('.chapter-title');

            // 更新文字
            chapterTitle.innerHTML = `${title} &nbsp;&nbsp;&nbsp; <span>${subtitle}</span>`;

            // 更新顏色和文字陰影
            if (chapterColors[title]) {
                chapterTitle.style.color = chapterColors[title].color;
                chapterTitle.style.textShadow = chapterColors[title].shadow;
            } else {
                // 預設顏色
                chapterTitle.style.color = "#fff";
                chapterTitle.style.textShadow = 
                    "0 0 5px #fff, 0 0 10px rgb(88, 255, 255), 0 0 20px #0ff, 0 0 30px rgba(0, 255, 255, 0.45)";
            }

            // 更新 URLtitle=${title}&subtitle=${subtitle}，不刷新頁面
            const newUrl = `${window.location.pathname}?title=${encodeURIComponent(playerName)}&subtitle=${encodeURIComponent(playerGrade)}&playerName=${encodeURIComponent(playerName)}&playerGrade=${encodeURIComponent(playerGrade)}`;
            history.replaceState(null, '', newUrl);
            
        }

        // 左右按鈕
        document.querySelector('.prev-btn').addEventListener('click', () => {
            currentIndex = (currentIndex - 1 + wrappers.length) % wrappers.length;
            updatePlanets();
        });

        document.querySelector('.next-btn').addEventListener('click', () => {
            currentIndex = (currentIndex + 1) % wrappers.length;
            updatePlanets();
        });

        // 上一章 / 下一章
        document.getElementById('prev-chapter').addEventListener('click', () => {
            currentIndex = (currentIndex - 1 + wrappers.length) % wrappers.length;
            updatePlanets();
        });

        document.getElementById('next-chapter').addEventListener('click', () => {
            currentIndex = (currentIndex + 1) % wrappers.length;
            updatePlanets();
        });

        // 新增：點擊星球滑入中間
        wrappers.forEach((w, i) => {
            w.querySelector('.planet').addEventListener('click', () => {
                if (i !== currentIndex) {  // 點擊非中間星球
                    currentIndex = i;
                    updatePlanets();
                }
            });
        });
        

        // 初始化
        updatePlanets();
        window.addEventListener('resize', updatePlanets);
    </script>

    <!-- 進入按鈕-章節轉跳 -->
    <script>
        // 點擊「進入章節」按鈕
        function enterChapter() {
            const currentPlanet = document.querySelector('.planet.center');
            if (!currentPlanet) return;

            const title = encodeURIComponent(currentPlanet.getAttribute('data-title'));
            const subtitle = encodeURIComponent(currentPlanet.getAttribute('data-subtitle'));

            // 跳轉到章節頁面，帶上 title & subtitle 參數
            window.location.href = `4-Game-Chapter.html?title=${title}&subtitle=${subtitle}`;
        }
    </script>

    <!-- 被返回後移到當前章節 -->
    <script>
        // 1️⃣ 在點擊「進入章節」按鈕前，把當前章節存到 sessionStorage
        function enterChapter() {
            const currentPlanet = document.querySelector('.planet.center');
            if (!currentPlanet) return;

            // 2️⃣ 取得章節標題與副標題
            const title = currentPlanet.getAttribute('data-title');
            const subtitle = currentPlanet.getAttribute('data-subtitle');

            // 3️⃣ 取得玩家名稱與年級（假設之前有存在 sessionStorage）
            const playerName = sessionStorage.getItem('playerName') || "未命名玩家";
            const playerGrade = sessionStorage.getItem('playerGrade') || "未設定年級";

            // 4️⃣ // 存入資料到 sessionStorage
            sessionStorage.setItem('currentChapterTitle', title);
            sessionStorage.setItem('currentChapterSubtitle', subtitle);
            sessionStorage.setItem('currentPlayerName', playerName);
            sessionStorage.setItem('currentPlayerGrade', playerGrade);
                
            console.log("✅ 已存入 sessionStorage：", {
                title, subtitle, playerName, playerGrade
            });

            // 5️⃣ 跳轉至下一頁，並帶參數
            window.location.href = `4-Game-Chapter.html?title=${encodeURIComponent(title)}&subtitle=${encodeURIComponent(subtitle)}`;
        }

        // 滑動到之前章節
        window.addEventListener('load', () => {
            const stored = sessionStorage.getItem('currentChapter');
            if (!stored) return;

            const { title, subtitle } = JSON.parse(stored);
            const wrappers = Array.from(document.querySelectorAll('.planet-track .planet-wrapper'));
            const targetIndex = wrappers.findIndex(w => {
                const p = w.querySelector('.planet');
                return p.getAttribute('data-title') === title && p.getAttribute('data-subtitle') === subtitle;
            });
            if (targetIndex === -1) return;

            let startIndex = 0;
            let animationStart = null;
            const duration = 600; // 動畫總時間(ms)，可調整
            const distance = targetIndex - startIndex;

            function easeInOut(t) {
                // 使用 sin 函數做 ease-in-out
                return 0.5 - 0.5 * Math.cos(Math.PI * t);
            }

            function animate(timestamp) {
                if (!animationStart) animationStart = timestamp;
                const elapsed = timestamp - animationStart;
                const progress = Math.min(elapsed / duration, 1); // 0~1
                const eased = easeInOut(progress);

                currentIndex = startIndex + Math.round(distance * eased);
                updatePlanets();

                if (progress < 1) {
                    requestAnimationFrame(animate);
                } else {
                    // 完成後清掉 sessionStorage
                    sessionStorage.removeItem('currentChapter');
                }
            }

            requestAnimationFrame(animate);
        });
    </script>
    

    <!-- 章節資訊傳入下一頁面 -->
    <script>
        // 通用跳轉 function： 轉跳頁面，並帶上 title & subtitle 參數
        function goToPage(page) {
            const title = sessionStorage.getItem('currentChapterTitle') || '';
            const subtitle = sessionStorage.getItem('currentChapterSubtitle') || '';
            const playerName = sessionStorage.getItem('currentPlayerName') || '';
            const playerGrade = sessionStorage.getItem('currentPlayerGrade') || '';
            window.location.href = `${page}.html?title=${encodeURIComponent(title)}&subtitle=${encodeURIComponent(subtitle)}&playerName=${encodeURIComponent(playerName)}&playerGrade=${encodeURIComponent(playerGrade)}`;

        }
        // ▶返回按鈕
        function enterBack() { goToPage('2-Game-home'); }
    </script>
</body>
</html>
